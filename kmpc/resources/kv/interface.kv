#:kivy 1.10.0
#:import SystemTabbedPanelItem kmpc.systempanel.SystemTabbedPanelItem
#:import PlaylistTabbedPanelItem kmpc.playlistpanel.PlaylistTabbedPanelItem
#:import LibraryTabbedPanelItem kmpc.librarypanel.LibraryTabbedPanelItem
#:import ExtraSlider kmpc.widgets.ExtraSlider
#:import OutlineTabbedPanelItem kmpc.widgets.OutlineTabbedPanelItem
#:import trackslidercursor kmpc.widgets.trackslidercursor

<AccessoryPopup@Popup>:
    auto_dismiss: False
    title: 'Accessory Power Off'
    size_hint_x: 0.6
    BoxLayout:
        valign: 'top'
        OutlineLabel:
            text: 'The system will power down after a predetermined time unless accessory power is restored.'
            text_size: root.width, None
            size: self.texture_size
            halign: 'center'
            valign: 'middle'

<KmpcInterface>:
    do_default_tab: False
    tab_width: self.width / 4
    active_tab: None
    backlight_min: 11
    backlight_max: 255
    OutlineTabbedPanelItem:
        text: 'Now Playing'
        BackdropBoxLayout:
            id: player
            orientation: 'vertical'
            BoxLayout:
                orientation: 'horizontal'
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_x: 0.05
                    SettingsButton:
                        text: u'\uf1de'
                        on_press: root.settings_popup()
                    SettingsButton:
                        text: u'\uf013'
                        on_press: app.open_settings()
                    SidewaysLabel:
                        id: remasterlabel
                        text: ''
                    SidewaysLabel:
                        id: yearlabel
                        text: ''
                    SidewaysLabel:
                        id: releasetypelabel
                        text: ''
                BoxLayout:
                    orientation: 'vertical'
                    BoxLayout:
                        id: trackinfo
                        size_hint_x: 1
                        orientation: 'vertical'
                    BoxLayout:
                        orientation: 'horizontal'
                        id: extended_info
                        size_hint_y: 0.33
                        BoxLayout:
                            id: album_cover_layout
                            size_hint_x: 0.2
                            padding_x: '10sp'
                        BoxLayout:
                            orientation: 'vertical'
                            InfoSmallLabel:
                                id: next_song_artist_label
                            ExtraSlider:
                                id: current_track_slider
                                update_slider: True
                                value_track: True
                                valign: 'center'
                                max: '1000'
                                cursor_image: trackslidercursor
                                cursor_width: sp(80)
                                cursor_height: sp(36)
                                on_touch_down: if self.collide_point(*args[1].pos): root.current_track_slider_down()
                                on_release: root.current_track_slider_release()
                                OutlineLabel:
                                    pos: (current_track_slider.value_pos[0] - sp(16), current_track_slider.center_y - sp(16))
                                    size_hint: None, None
                                    size: sp(32), sp(32)
                                    text: "%02d:%02d" % (divmod(int(current_track_slider.max)-int(current_track_slider.value),60))
                            BoxLayout:
                                orientation: 'horizontal'
                                padding: sp(20),0,sp(20),0
                                OutlineLabel:
                                    id: current_track_time_label
                                    size_hint_x: 0.1
                                    valign: 'center'
                                    halign: 'left'
                                    size: self.texture_size
                                    text: "%02d:%02d" % (divmod(int(current_track_slider.value),60))
                                OutlineLabel:
                                    padding_x: '10sp'
                                    text_size: self.size
                                    id: current_playlist_track_number_label
                                    text: '1 of 10'
                                    halign: 'center'
                                    valign: 'middle'
                                OutlineLabel:
                                    id: current_track_totaltime_label
                                    size_hint_x: 0.1
                                    valign: 'center'
                                    halign: 'right'
                                    size: self.texture_size
                                    text: "%02d:%02d" % (divmod(int(current_track_slider.max),60))
                        BoxLayout:
                            size_hint_x: 0.2
                            id: song_star_layout
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_x: 0.05
                    BrightnessButton:
                        text: u'\uf240'
                        on_press: root.change_backlight(root.backlight_max)
                    BrightnessButton:
                        text: u'\uf242'
                        on_press: root.change_backlight(100)
                    BrightnessButton:
                        text: u'\uf243'
                        on_press: root.change_backlight(35)
                    BrightnessButton:
                        text: u'\uf244'
                        on_press: root.change_backlight(root.backlight_min)
            BoxLayout:
                size_hint: (1,0.10)
                orientation: 'horizontal'
                MediaButton:
                    id: prev_button
                    text: u"\uf049"
                    on_press: root.prev_pressed()
                MediaToggleButton:
                    id: play_button
                    text: u"\uf04b"
                    on_press: root.play_pressed()
                MediaButton:
                    id: next_button
                    text: u"\uf050"
                    on_press: root.next_pressed()
                MediaToggleButton:
                    id: repeat_button
                    text: u"\uf079"
                    on_press: root.repeat_pressed()
                MediaToggleButton:
                    id: single_button
                    text: u"\uf192"
                    on_press: root.single_pressed()
                MediaToggleButton:
                    id: random_button
                    text: u"\uf074"
                    on_press: root.random_pressed()
                MediaToggleButton:
                    id: consume_button
                    text: u"\uf147"
                    on_press: root.consume_pressed()
    PlaylistTabbedPanelItem:
        id: playlist_tab
    LibraryTabbedPanelItem:
        id: library_tab
    SystemTabbedPanelItem:
        id: system_tab
